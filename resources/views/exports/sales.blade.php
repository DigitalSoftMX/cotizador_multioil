<table border="1">
    <thead>
        <tr>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2">{{ __('CLIENTE') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2">{{ __('FLETE') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2">{{ __('FLETERA') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" colspan="3">{{ __('PRECIO DE COMPRA') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" colspan="3">{{ __('PRECIO DE VENTA') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="13">{{ __('DIFERENCIA') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="13">
                <p style="text-align: justify;"> {{ __('% DE UTILIDAD') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;"> {{ __('FECHA DE SOLICITUD') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;"> {{ __('FECHA DE DESPACHO') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('LITROS SOLICITADOS') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="13">{{ __('PRODUCTO') }} </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="16">{{ __('APROX A PAGAR') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('LITROS DESPACHADOS') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('SOBRANTE') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('PAGO DEL CLIENTE') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15" height="30">
                <p style="text-align: justify;">{{ __('PAGO DEL CLIENTE GUERRERA') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('PAGO GUERRERA VALERO') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="16">{{ __('PAGO A FLETERA') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="20">
                <p style="text-align: justify;">{{ __('FACTURA VALERO - GUERRERA') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="20">
                <p style="text-align: justify;">{{ __('CANTIDAD FACTURADA VALERO - GUERRERA') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="20">
                <p style="text-align: justify;">{{ __('DIFERENCIA DE PAGO CONTRA FACTURA VALERO') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="16">
                <p style="text-align: justify;">{{ __('PRECIO EN FACTURA') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="16">
                <p style="text-align: justify;">{{ __('DIFERENCIA CON PC') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="13">{{ __('FACTURA') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('CANTIDAD FACTURADA') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="13">{{ __('DIFERENCIA') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="20">
                <p style="text-align: justify;">{{ __('DIFERENCIA ENTRE FACTURAS') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">{{ __('COMISIÓN') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('UTILIDAD COMISIONISTA 1') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('UTILIDAD COMISIONISTA 2') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('UTILIDAD GUERRERA') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('UTILIDAD MULTIOIL') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('UTILIDAD MULTIOIL SIN IVA') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="13">{{ __('DIFERENCIA') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('20% DE CAJA MULTIOIL') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="15">
                <p style="text-align: justify;">{{ __('RESTANTE UTILIDAD SIN IVA - 20% CAJA') }}</p>
            </td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#34495E" rowspan="2" width="13">
                <p style="text-align: justify;">{{ __('UTILIDAD POR SOCIO') }}</p>
            </td>
        </tr>
        <tr>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#05AB00" width="12" height="20">{{ __('REGULAR') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#E40404" width="12">{{ __('PREMIUM') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="black" width="12">{{ __('DIÉSEL') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#05AB00" width="12">{{ __('REGULAR') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="#E40404" width="12">{{ __('PREMIUM') }}</td>
            <td style="font-weight:bold;color:#ffffff;vertical-align:center" align="center" bgcolor="black" width="12">{{ __('DIESEL') }}</td>
        </tr>
    </thead>
    <tbody>
        @foreach ($orders as $order)
            <tr>
                <td width="40">{{ $order->company->name }}</td>
                <td>{{ $flete = $order->freight == 0 ? 'NO' : 'SI' }}</td>
                <td>{{ $order->name_freight }}</td>
                <td>{{ $regularCompra = $order->product == 'regular' ? $order->price : '' }}</td>
                <td>{{ $premiumCompra = $order->product == 'premium' ? $order->price : '' }}</td>
                <td>{{ $dieselCompra = $order->product == 'diesel' ? $order->price : '' }}</td>
                <td>{{ $regularVenta = $order->product == 'regular' ? $order->sale_price : '' }}</td>
                <td>{{ $premiumVenta = $order->product == 'premium' ? $order->sale_price : '' }}</td>
                <td>{{ $dieselVenta = $order->product == 'diesel' ? $order->sale_price : '' }}</td>
                <td>@switch($order->product)
                        @case('regular')
                            {{ $diferenciaPrecio = $regularVenta - $regularCompra }}
                        @break
                        @case('premium')
                            {{ $diferenciaPrecio = $premiumVenta - $premiumCompra }}
                        @break
                        @case('diesel')
                            {{ $diferenciaPrecio = $dieselVenta - $dieselCompra }}
                        @break
                    @endswitch
                </td>
                <td>
                    @php
                        try {
                            echo '$' . number_format((($diferenciaPrecio * $order->dispatched_liters) / ($order->sale_price * $order->dispatched_liters)) * 100, 2) . '%';
                        } catch (\Throwable $th) {
                            echo '';
                        }
                    @endphp
                </td>
                <td>{{ Carbon\Carbon::parse($order->created_at)->format('d/m/Y') }}</td>
                <td>{{ Carbon\Carbon::parse($order->date)->format('d/m/Y') }}</td>
                <td>{{ $litrosSolicitados = $order->liters }}</td>
                <td style="color:{{$order->product=='diesel'?'#ffffff':''}};" bgcolor="{{$order->product=='regular'?'#05AB00': ($order->product=='premium'?'#E40404' : '#000000')}}" >{{ strtoupper($order->product) }}</td>
                <td>{{ '$' . number_format($aproxAPagar = $order->sale_price * $order->liters, 2) }}</td>
                <td>{{ $litrosDespachados = $order->dispatched_liters }}</td>
                <td style="color:{{($sobrante = $litrosSolicitados - $litrosDespachados)<=0?'#05AB00':'#E40404'}}">{{$sobrante}}</td>
                <td>
                    {{ '$' . number_format($pagoDelCliente = $order->sale_price * $litrosDespachados, 2) }}
                </td>
                <td>{{ '$' . number_format($pagoClienteGuerrera = $order->payments->sum('payment_guerrera'), 2) }}
                </td>
                <td>{{ '$' . number_format($pagoGuerreraValero = $order->payments->sum('payment_g_valero'), 2) }}
                </td>
                <td>{{ '$' . number_format($pagoFletera = $order->payments->sum('payment_freight'), 2) }}</td>
                <td>{{ $facturaValeroGuerrera = $order->invoicecfdi }}</td>
                <td>{{ '$' . number_format($cantidadFacturadaValeroGuerrera = $order->invoicepayment,2)}}</td>
                <td style="color: {{($diferenciaDePagoContraFacturaValero=$cantidadFacturadaValeroGuerrera-$pagoGuerreraValero)<=0?'#05AB00':'#E40404'}}">{{ '$' . number_format($diferenciaDePagoContraFacturaValero,2)}}</td>
                <td>
                    @php
                        try {
                            echo '$'. number_format($precioEnFactura=$cantidadFacturadaValeroGuerrera/$litrosDespachados,2);
                        } catch (\Throwable $th) {
                            echo '';
                        }
                    @endphp
                </td>
                <td>{{'$'. number_format($precioEnFactura-($regularCompra!=''?$regularCompra:($premiumCompra!=''?$premiumCompra:$dieselCompra)),2)}}</td>
                <td>{{ $order->CFDI }}</td>
                <td>{{ '$' . number_format($cantidadFacturada = $order->invoice, 2) }}</td>
                <td style="color: {{($diferenciaPago = $cantidadFacturada - $pagoClienteGuerrera)<=0?'#05AB00':'#E40404'}}">{{ '$' . number_format($diferenciaPago, 2) }}</td>
                <td>{{ '$' . number_format($cantidadFacturada-$cantidadFacturadaValeroGuerrera, 2) }}</td>
                <td>{{ '$' . number_format($comision = ($diferenciaPrecio * $litrosDespachados - $pagoFletera), 2) }}</td>
                <td>
                    @if ($order->commission != null)
                        {{ '$' . number_format($utilidadComisionista1 = $order->commission * $litrosDespachados - $pagoFletera / 2, 2) }}
                    @endif
                </td>
                <td>
                    @if ($order->commission_two != null)
                        {{ '$' . number_format($utilidadComisionista2 = $order->commission_two * $litrosDespachados - $pagoFletera / 2, 2) }}
                        {{-- {{ '$' . number_format($order->commission * $litrosDespachados, 2) }} --}}
                    @endif
                </td>
                <td>{{ '$' . number_format($utilidadGuerrera = $comision * 0.2, 2) }}</td>
                <td>{{ '$' . number_format($utilidadMultioil = $comision * 0.8, 2) }}</td>
                <td>{{ '$' . number_format($utilidadMultioilSinIVA = $utilidadMultioil / 1.16, 2) }}</td>
                <td>{{ '$' . number_format($diferenciaUtilidad = $utilidadMultioil - $utilidadMultioilSinIVA, 2) }}
                </td>
                <td>{{ '$' . number_format($cajaMultioil = $utilidadMultioilSinIVA * 0.2, 2) }}</td>
                <td>{{ '$' . number_format($restanteUtilidadSinVIVA = $utilidadMultioilSinIVA - $cajaMultioil, 2) }}
                </td>
                <td>{{ '$' . number_format($restanteUtilidadSinVIVA / 2, 2) }}</td>
            </tr>
        @endforeach
    </tbody>
</table>
